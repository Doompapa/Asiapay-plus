(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-6152ef94","chunk-1be4c3a0","chunk-e37eded2"],{"0fea":function(e,t,a){"use strict";a.d(t,"cb",(function(){return s})),a.d(t,"db",(function(){return r})),a.d(t,"d",(function(){return n})),a.d(t,"K",(function(){return i})),a.d(t,"J",(function(){return c})),a.d(t,"N",(function(){return l})),a.d(t,"P",(function(){return u})),a.d(t,"h",(function(){return d})),a.d(t,"f",(function(){return f})),a.d(t,"g",(function(){return p})),a.d(t,"r",(function(){return m})),a.d(t,"o",(function(){return g})),a.d(t,"y",(function(){return h})),a.d(t,"C",(function(){return b})),a.d(t,"c",(function(){return w})),a.d(t,"v",(function(){return v})),a.d(t,"H",(function(){return y})),a.d(t,"u",(function(){return P})),a.d(t,"Q",(function(){return O})),a.d(t,"B",(function(){return j})),a.d(t,"q",(function(){return C})),a.d(t,"i",(function(){return k})),a.d(t,"l",(function(){return x})),a.d(t,"k",(function(){return S})),a.d(t,"j",(function(){return $})),a.d(t,"n",(function(){return L})),a.d(t,"m",(function(){return T})),a.d(t,"F",(function(){return A})),a.d(t,"E",(function(){return I})),a.d(t,"I",(function(){return N})),a.d(t,"s",(function(){return U})),a.d(t,"t",(function(){return G})),a.d(t,"M",(function(){return q})),a.d(t,"L",(function(){return _})),a.d(t,"e",(function(){return B})),a.d(t,"D",(function(){return F})),a.d(t,"p",(function(){return R})),a.d(t,"a",(function(){return M})),a.d(t,"O",(function(){return Q})),a.d(t,"G",(function(){return D})),a.d(t,"x",(function(){return H})),a.d(t,"w",(function(){return K})),a.d(t,"z",(function(){return z})),a.d(t,"A",(function(){return J})),a.d(t,"b",(function(){return W})),a.d(t,"hb",(function(){return Z})),a.d(t,"U",(function(){return V})),a.d(t,"bb",(function(){return Y})),a.d(t,"eb",(function(){return X})),a.d(t,"X",(function(){return ee})),a.d(t,"W",(function(){return te})),a.d(t,"gb",(function(){return ae})),a.d(t,"fb",(function(){return oe})),a.d(t,"Y",(function(){return se})),a.d(t,"V",(function(){return re})),a.d(t,"S",(function(){return ne})),a.d(t,"T",(function(){return ie})),a.d(t,"Z",(function(){return ce})),a.d(t,"ab",(function(){return le})),a.d(t,"R",(function(){return ue}));var o=a("4667"),s={list:function(e,t){return o["a"].request({url:e,method:"GET",params:t},!0,!0,!1)},add:function(e,t){return o["a"].request({url:e,method:"POST",data:t},!0,!0,!1)},getById:function(e,t){return o["a"].request({url:e+"/"+t,method:"GET"},!0,!0,!1)},updateById:function(e,t,a){return o["a"].request({url:e+"/"+t,method:"PUT",data:a},!0,!0,!1)},delById:function(e,t){return o["a"].request({url:e+"/"+t,method:"DELETE"},!0,!0,!1)},postNormal:function(e,t){return o["a"].request({url:e+"/"+t,method:"POST"},!0,!0,!0)},postDataNormal:function(e,t,a){return o["a"].request({url:e+"/"+t,method:"POST",data:a},!0,!0,!0)},getNormal:function(e,t){return o["a"].request({url:e+"/"+t,method:"GET"},!0,!0,!0)}},r={list:function(e,t){return o["a"].request({url:e,method:"GET",params:t},!0,!0,!0)},add:function(e,t){return o["a"].request({url:e,method:"POST",data:t},!0,!0,!0)},getById:function(e,t){return o["a"].request({url:e+"/"+t,method:"GET"},!0,!0,!0)},updateById:function(e,t,a){return o["a"].request({url:e+"/"+t,method:"PUT",data:a},!0,!0,!0)},delById:function(e,t){return o["a"].request({url:e+"/"+t,method:"DELETE"},!0,!0,!0)}},n="/api/sysEnts",i="/api/sysRoles",c="/api/sysRoleEntRelas",l="/api/sysUsers",u="/api/sysUserRoleRelas",d="/api/isvInfo",f="/api/isvBalance",p="/api/agentHistory",m="/api/mchInfo",g="/api/mchBalance",h="/api/mchStatInfo",b="/api/passageStatInfo",w="/api/agentStatInfo",v="/api/mchProductInfo",y="/api/productMchInfo",P="/api/mchPassageInfo",O="/api/payOrder",j="/api/passageMchInfo",C="/api/mchHistory",k="/api/mchApps",x="/api/mchAppsList",S="/api/passageHistory",$="/api/mchAppsBalance",L="/api/mchAppsBalanceReset",T="/api/mchAppsMultipleSet",A="/api/payOrder",I="/api/payOrderForceList",N="/api/refundOrder",U="/api/mchNotify",G="/api/mchNotifyResend/resendAll",q="api/sysLog",_="api/sysConfigs",E="api/mainChart",B="/api/payIfDefines",F="/api/payWays",R="/api/mchDivision",M="/api/agentDivision",Q="/api/transferOrders",D="/api/platStat",H="/api/mchStat",K="/api/mchProductStat",z="/api/passageStat",J="/api/productStat",W="/api/agentStat",Z={avatar:o["a"].baseUrl+"/api/ossFiles/avatar",ifBG:o["a"].baseUrl+"/api/ossFiles/ifBG",cert:o["a"].baseUrl+"/api/ossFiles/cert"};function V(e){return o["a"].request({url:"/api/sysEnts/showTree?sysType="+e,method:"GET"})}function Y(e,t,a){return o["a"].request({url:"/api/payOrder/refunds/"+e,method:"POST",data:{refundAmount:t,refundReason:a}})}function X(e,t){return o["a"].request({url:"api/sysUserRoleRelas/relas/"+e,method:"POST",data:{roleIdListStr:JSON.stringify(t)}})}function ee(){return o["a"].request({url:E+"/twoDayCount",method:"GET"})}function te(){return o["a"].request({url:E+"/realTimeCount",method:"GET"})}function ae(e){return o["a"].request({url:"/api/current/modifyPwd",method:"put",data:e})}function oe(e){return o["a"].request({url:"/api/current/user",method:"put",data:e})}function se(){return o["a"].request({url:"/api/current/user",method:"get"})}function re(){return o["a"].request({url:"/api/current/getGoogleKey",method:"get"})}function ne(e){return o["a"].request({url:_+"/"+e,method:"GET"})}function ie(e,t){return o["a"].request({url:"/api/sysEnts/bySysType",method:"GET",params:{entId:e,sysType:t}})}function ce(e){return o["a"].request({url:"/api/mchNotify/resend/"+e,method:"POST"})}function le(e){return o["a"].request({url:"/api/passageTest/doPay",method:"POST",data:e})}function ue(e,t){return o["a"].request({url:e,method:"POST",data:t,responseType:"arraybuffer"},!0,!1,!0)}},"2be6":function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-drawer",{staticClass:"drawer-width",attrs:{maskClosable:!1,visible:e.visible,title:e.isAdd?"新增商户":"修改商户","body-style":{paddingBottom:"80px"},width:"40%"},on:{close:e.onClose}},[e.visible?a("a-form-model",{ref:"infoFormModel",attrs:{model:e.saveObject,layout:"vertical",rules:e.rules}},[a("a-row",{attrs:{justify:"space-between",type:"flex"}},[a("a-col",{attrs:{span:10}},[a("a-form-model-item",{attrs:{label:"商户名称",prop:"mchName"}},[a("a-input",{attrs:{placeholder:"请输入商户名称",disabled:"测试商户"===e.saveObject.mchName},model:{value:e.saveObject.mchName,callback:function(t){e.$set(e.saveObject,"mchName",t)},expression:"saveObject.mchName"}})],1)],1),a("a-col",{attrs:{span:10}},[a("a-form-model-item",{attrs:{label:"登录名",prop:"loginUserName"}},[a("a-input",{attrs:{placeholder:"请输入商户登录名",disabled:!this.isAdd},model:{value:e.saveObject.loginUserName,callback:function(t){e.$set(e.saveObject,"loginUserName",t)},expression:"saveObject.loginUserName"}})],1)],1)],1),a("a-row",{attrs:{justify:"space-between",type:"flex"}},[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{attrs:{label:"代理商号",prop:"isvNo"}},[a("a-select",{attrs:{placeholder:"请选择代理商",allowClear:!0},model:{value:e.saveObject.agentNo,callback:function(t){e.$set(e.saveObject,"agentNo",t)},expression:"saveObject.agentNo"}},e._l(e.isvList,(function(t){return a("a-select-option",{key:t.agentNo,attrs:{value:t.agentNo}},[e._v(" "+e._s(t.agentName+" [ ID: "+t.agentNo+" ]")+" ")])})),1)],1)],1)],1),a("a-row",[a("a-col",{attrs:{span:10}},[a("a-form-model-item",{attrs:{label:"状态",prop:"state"}},[a("a-radio-group",{model:{value:e.saveObject.state,callback:function(t){e.$set(e.saveObject,"state",t)},expression:"saveObject.state"}},[a("a-radio",{attrs:{value:1}},[e._v(" 启用 ")]),a("a-radio",{attrs:{value:0}},[e._v(" 禁用 ")])],1)],1)],1)],1),a("a-row",{attrs:{justify:"space-between",type:"flex"}},[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{attrs:{label:"商户私钥",prop:"secret"}},[a("a-input",{attrs:{placeholder:e.appSecret_ph,type:"textarea"},model:{value:e.saveObject.secret,callback:function(t){e.$set(e.saveObject,"secret",t)},expression:"saveObject.secret"}}),a("a-button",{attrs:{type:"primary",ghost:""},on:{click:function(t){return e.randomKey(!1,128,0)}}},[a("a-icon",{attrs:{type:"file-sync"}}),e._v("随机生成私钥")],1)],1)],1)],1),a("a-row",{attrs:{justify:"space-between",type:"flex"}},[a("a-col",{attrs:{span:24}},[a("a-form-model-item",{attrs:{label:"备注",prop:"remark"}},[a("a-input",{attrs:{placeholder:"请输入备注",type:"textarea"},model:{value:e.saveObject.remark,callback:function(t){e.$set(e.saveObject,"remark",t)},expression:"saveObject.remark"}})],1)],1)],1),a("a-row",{attrs:{justify:"space-between",type:"flex"}},[a("a-col",{attrs:{span:24}},[e.resetIsShow?a("a-divider",{attrs:{orientation:"left"}},[a("a-tag",{attrs:{color:"#FF4B33"}},[e._v(" 账户安全 ")])],1):e._e()],1)],1),a("div",[a("a-row",{attrs:{justify:"space-between",type:"flex"}},[a("a-col",{attrs:{span:10}},[e.resetIsShow?a("a-form-model-item",{attrs:{label:""}},[e._v(" 重置密码并解绑谷歌验证："),a("a-checkbox",{model:{value:e.sysPassword.resetPass,callback:function(t){e.$set(e.sysPassword,"resetPass",t)},expression:"sysPassword.resetPass"}})],1):e._e()],1),a("a-col",{attrs:{span:10}},[e.sysPassword.resetPass?a("a-form-model-item",{attrs:{label:""}},[e._v(" 恢复默认密码："),a("a-checkbox",{on:{click:e.isResetPass},model:{value:e.sysPassword.defaultPass,callback:function(t){e.$set(e.sysPassword,"defaultPass",t)},expression:"sysPassword.defaultPass"}})],1):e._e()],1)],1)],1),e.sysPassword.resetPass?a("div",[a("div",{directives:[{name:"show",rawName:"v-show",value:!this.sysPassword.defaultPass,expression:"!this.sysPassword.defaultPass"}]},[a("a-row",{attrs:{justify:"space-between",type:"flex"}},[a("a-col",{attrs:{span:10}},[a("a-form-model-item",{attrs:{label:"新密码：",prop:"newPwd"}},[a("a-input-password",{attrs:{autocomplete:"new-password",disabled:e.sysPassword.defaultPass},model:{value:e.newPwd,callback:function(t){e.newPwd=t},expression:"newPwd"}})],1)],1),a("a-col",{attrs:{span:10}},[a("a-form-model-item",{attrs:{label:"确认新密码：",prop:"confirmPwd"}},[a("a-input-password",{attrs:{autocomplete:"new-password",disabled:e.sysPassword.defaultPass},model:{value:e.sysPassword.confirmPwd,callback:function(t){e.$set(e.sysPassword,"confirmPwd",t)},expression:"sysPassword.confirmPwd"}})],1)],1)],1)],1)]):e._e()],1):e._e(),a("div",{staticClass:"drawer-btn-center"},[a("a-button",{staticStyle:{"margin-right":"8px"},style:{marginRight:"8px"},attrs:{icon:"close"},on:{click:e.onClose}},[e._v(" 取消 ")]),a("a-button",{attrs:{type:"primary",icon:"check",loading:e.btnLoading},on:{click:e.handleOkFunc}},[e._v(" 保存 ")])],1)],1)},s=[],r=a("0fea"),n=a("27ae"),i={props:{callbackFunc:{type:Function}},data:function(){var e=this,t=function(e,t,a){a()};return{newPwd:"",resetIsShow:!1,sysPassword:{resetPass:!1,defaultPass:!0,confirmPwd:""},btnLoading:!1,isAdd:!0,saveObject:{},recordId:null,visible:!1,isvList:null,appSecret_ph:"请输入",rules:{mchName:[{required:!0,message:"请输入商户名称",trigger:"blur"}],loginUserName:[{required:!0,pattern:/^[a-zA-Z][a-zA-Z0-9]{5,17}$/,message:"请输入字母开头，长度为6-18位的登录名",trigger:"blur"}],isvNo:[{validator:t,trigger:"blur"}],secret:[{required:!0,pattern:/^[a-zA-Z0-9]{128}$/,message:"请点击生成私钥",trigger:"blur"}],newPwd:[{required:!1,trigger:"blur"},{validator:function(t,a,o){e.sysPassword.defaultPass||(e.newPwd.length<6||e.newPwd.length>12)&&o("请输入6-12位新密码"),o()}}],confirmPwd:[{required:!1,trigger:"blur"},{validator:function(t,a,o){e.sysPassword.defaultPass||e.newPwd===e.sysPassword.confirmPwd?o():o("新密码与确认密码不一致")}}]}}},created:function(){},methods:{show:function(e){this.isAdd=!e,this.saveObject={state:1,secret:""},void 0!==this.$refs.infoFormModel&&this.$refs.infoFormModel.resetFields();var t=this;r["cb"].list(r["h"],{pageSize:-1,state:1}).then((function(e){t.isvList=e.records})),this.isAdd?t.visible=!0:(console.log(555),t.resetIsShow=!0,t.recordId=e,r["cb"].getById(r["r"],e).then((function(e){t.saveObject=e})),this.visible=!0)},randomKey:function(e,t,a){var o="",s=t,r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"];e&&(s=Math.round(Math.random()*(a-t))+t);for(var n=0;n<s;n++){var i=Math.round(Math.random()*(r.length-1));o+=r[i]}this.saveObject.secret=o},handleOkFunc:function(){var e=this,t=this;null!=this.saveObject.agentNo&&void 0!==this.saveObject.agentNo||(this.saveObject.agentNo=""),this.$refs.infoFormModel.validate((function(a){a&&(t.isAdd?(e.btnLoading=!0,r["cb"].add(r["r"],t.saveObject).then((function(e){t.$message.success("新增成功"),t.visible=!1,t.callbackFunc(),t.btnLoading=!1})).catch((function(e){t.btnLoading=!1}))):(t.sysPassword.confirmPwd=n["Base64"].encode(t.sysPassword.confirmPwd),Object.assign(t.saveObject,t.sysPassword),r["cb"].updateById(r["r"],t.recordId,t.saveObject).then((function(e){t.$message.success("修改成功"),t.visible=!1,t.callbackFunc(),t.btnLoading=!1,t.resetIsShow=!0,t.sysPassword.resetPass=!1,t.sysPassword.defaultPass=!0,t.resetPassEmpty(t)})).catch((function(e){t.btnLoading=!1,t.resetIsShow=!0,t.sysPassword.resetPass=!1,t.sysPassword.defaultPass=!0,t.resetPassEmpty(t)}))))}))},onClose:function(){this.visible=!1,this.resetIsShow=!1,this.sysPassword.resetPass=!1,this.resetPassEmpty(this),this.sysPassword.defaultPass=!0},searchFunc:function(){this.$refs.infoTable.refTable(!0)},isResetPass:function(){this.sysPassword.defaultPass||(this.newPwd="",this.sysPassword.confirmPwd="")},resetPassEmpty:function(e){e.newPwd="",e.sysPassword.confirmPwd=""}}},c=i,l=(a("a850"),a("2877")),u=Object(l["a"])(c,o,s,!1,null,null,null);t["default"]=u.exports},"5ab5":function(e,t,a){"use strict";a("712e")},"6c40":function(e,t,a){},"712e":function(e,t,a){},"909a":function(e,t,a){"use strict";var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",[a("a-upload",{attrs:{name:"file",action:e.action,headers:e.headers,accept:e.accept,showUploadList:!1,multiple:!0,"before-upload":e.beforeUpload},on:{change:e.handleChange}},[e._t("uploadSlot",null,{loading:e.loading})],2)],1)},s=[],r=(a("a9e3"),a("381c")),n=a("ffef");function i(){var e={};return e[r["b"].ACCESS_TOKEN_NAME]=n["a"].getToken(),e}var c={name:"JeepayUpload",props:{action:{type:String,default:""},accept:{type:String,default:""},size:{type:Number,default:10},num:{type:Number,default:1}},data:function(){return{loading:!1,fileList:[],headers:i()}},created:function(){},methods:{handleChange:function(e){var t=e.file.response;"uploading"===e.file.status&&(this.loading=!0),"done"===e.file.status?(0!==t.code&&this.$message.error(t.msg),this.loading=!1,this.$emit("uploadSuccess",t.data)):"error"===e.file.status&&(console.log(e),this.$message.error("上传失败"))},beforeUpload:function(e){var t=e.size/1024/1024<this.size;return t||this.$message.error("文件应小于"+this.size+"M!"),t}}},l=c,u=a("2877"),d=Object(u["a"])(l,o,s,!1,null,null,null);t["a"]=d.exports},a363:function(e,t,a){"use strict";a("6c40")},a664:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticStyle:{background:"#fff","border-radius":"10px"}},[a("a-tabs",{on:{change:e.selectTabs}},[a("a-tab-pane",{key:"1",attrs:{tab:"基本信息"}},[a("div",{staticClass:"account-settings-info-view"},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{md:16,lg:16}},[a("a-form-model",{ref:"infoFormModel",attrs:{model:e.saveObject,"label-col":{span:9},"wrapper-col":{span:10}}},[a("a-form-model-item",{attrs:{label:"用户登录名:"}},[a("a-input",{attrs:{disabled:""},model:{value:e.saveObject.loginUsername,callback:function(t){e.$set(e.saveObject,"loginUsername",t)},expression:"saveObject.loginUsername"}})],1),a("a-form-model-item",{attrs:{label:"开启谷歌验证："}},[a("a-radio-group",{on:{change:e.googleAuthChange},model:{value:e.googleAuth,callback:function(t){e.googleAuth=t},expression:"googleAuth"}},[a("a-radio",{attrs:{value:1}},[e._v("启用")]),a("a-radio",{attrs:{value:0}},[e._v("禁用")])],1)],1),a("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.showGoogleQrCode,expression:"showGoogleQrCode"}],attrs:{label:"请使用Google身份验证器扫描码："}},[a("GoogleAuthQrCode",{ref:"googleAuthQrCode"})],1),a("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.showGoogleQrCode,expression:"showGoogleQrCode"}],attrs:{label:"Google验证码："}},[a("a-input",{attrs:{type:"number"},model:{value:e.googleCode,callback:function(t){e.googleCode=t},expression:"googleCode"}})],1),a("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.showGoogleTryCancel,expression:"showGoogleTryCancel"}],attrs:{label:"Google验证码："}},[a("a-input",{attrs:{type:"number"},model:{value:e.googleCode,callback:function(t){e.googleCode=t},expression:"googleCode"}})],1)],1),a("a-form-item",{staticStyle:{display:"flex","justify-content":"center"}},[a("a-button",{attrs:{type:"primary",icon:"check-circle",disabled:e.canUpdate,loading:e.btnLoading},on:{click:e.changeInfo}},[e._v("确认更新")])],1)],1)],1)],1)]),a("a-tab-pane",{key:"2",attrs:{tab:"密码设置"}},[a("div",{staticClass:"account-settings-info-view"},[a("a-row",{attrs:{gutter:16}},[a("a-col",{attrs:{md:16,lg:16}},[a("a-form-model",{ref:"pwdFormModel",attrs:{model:e.updateObject,"label-col":{span:9},"wrapper-col":{span:10},rules:e.rulesPass}},[a("a-form-model-item",{attrs:{label:"原密码：",prop:"originalPwd"}},[a("a-input-password",{attrs:{autocomplete:"new-password",placeholder:"请输入原密码"},model:{value:e.updateObject.originalPwd,callback:function(t){e.$set(e.updateObject,"originalPwd",t)},expression:"updateObject.originalPwd"}})],1),a("a-form-model-item",{attrs:{label:"新密码：",prop:"newPwd"}},[a("a-input-password",{attrs:{autocomplete:"new-password",placeholder:"请输入新密码"},model:{value:e.updateObject.newPwd,callback:function(t){e.$set(e.updateObject,"newPwd",t)},expression:"updateObject.newPwd"}})],1),a("a-form-model-item",{attrs:{label:"确认新密码：",prop:"confirmPwd"}},[a("a-input-password",{attrs:{autocomplete:"new-password",placeholder:"确认新密码"},model:{value:e.updateObject.confirmPwd,callback:function(t){e.$set(e.updateObject,"confirmPwd",t)},expression:"updateObject.confirmPwd"}})],1)],1),a("a-form-item",{staticStyle:{display:"flex","justify-content":"center"}},[a("a-button",{attrs:{type:"primary",icon:"safety-certificate",loading:e.btnLoading},on:{click:e.confirm}},[e._v("更新密码")])],1)],1)],1)],1)])],1)],1)},s=[],r=a("909a"),n=a("0fea"),i=a("b3ab"),c=a("4360"),l=a("7ded"),u=a("27ae"),d=a("57cd"),f=a("2be6"),p={components:{InfoAddOrEdit:f["default"],AvatarModal:i["default"],JeepayUpload:r["a"],GoogleAuthQrCode:d["default"]},data:function(){var e=this;return{action:n["hb"].avatar,btnLoading:!1,saveObject:{loginUsername:""},googleCode:"",googleAuth:0,googleKey:"",originalGoogleAuth:0,showGoogleTryCancel:!1,canUpdate:!0,updateObject:{originalPwd:"",newPwd:"",confirmPwd:""},showGoogleQrCode:!1,recordId:c["a"].state.user.userId,rulesPass:{originalPwd:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPwd:[{min:6,max:12,required:!0,message:"请输入6-12位新密码",trigger:"blur"}],confirmPwd:[{required:!0,message:"请确认输入新密码",trigger:"blur"},{validator:function(t,a,o){e.updateObject.newPwd===a?o():o("新密码与确认密码不一致")}}]}}},computed:{},created:function(){this.detail()},methods:{detail:function(){var e=this;Object(n["Y"])().then((function(t){e.saveObject=t,e.googleAuth=t.googleAuth,e.originalGoogleAuth=t.googleAuth}))},googleAuthChange:function(){var e=this;1===this.googleAuth&&0===this.originalGoogleAuth?(e.$store.commit("showLoading"),Object(n["V"])().then((function(t){e.$store.commit("hideLoading"),e.$refs.googleAuthQrCode.show(t.qrCode),e.googleKey=t.key,e.showGoogleQrCode=!0,e.showGoogleTryCancel=!1,e.canUpdate=!1}))):1===this.originalGoogleAuth&&0===this.googleAuth?(e.showGoogleTryCancel=!0,e.googleKey="",e.canUpdate=!1):(e.showGoogleQrCode=!1,e.googleCode="",e.canUpdate=!0,e.showGoogleTryCancel=!1)},changeInfo:function(){var e=this,t=this;this.$refs.infoFormModel.validate((function(a){a&&e.$infoBox.confirmPrimary("确认更新信息吗？","",(function(){t.btnLoading=!0,t.$store.commit("showLoading"),t.saveObject.googleAuth=t.googleAuth,t.saveObject.googleKey=t.googleKey,t.saveObject.googleCode=t.googleCode,Object(n["fb"])(t.saveObject).then((function(e){return t.btnLoading=!1,t.showGoogleQrCode=!1,t.googleCode="",t.canUpdate=!0,t.showGoogleTryCancel=!1,t.$store.commit("hideLoading"),Object(l["a"])()})).then((function(e){c["a"].commit("SET_USER_INFO",e),t.originalGoogleAuth=e.googleAuth,t.$message.success("修改成功")})).catch((function(e){t.$store.commit("hideLoading"),t.btnLoading=!1,console.log(e),t.$message.error("修改失败")}))}))}))},confirm:function(e){var t=this,a=this;this.$refs.pwdFormModel.validate((function(e){e&&t.$infoBox.confirmPrimary("确认更新密码吗？","",(function(){a.btnLoading=!0,a.confirmLoading=!0,a.updateObject.recordId=a.recordId,a.updateObject.originalPwd=u["Base64"].encode(a.updateObject.originalPwd),a.updateObject.confirmPwd=u["Base64"].encode(a.updateObject.confirmPwd),t.$delete(t.updateObject,"newPwd"),Object(n["gb"])(a.updateObject).then((function(e){a.$message.success("修改成功"),t.$store.dispatch("Logout").then((function(){t.$router.push({name:"login"})}))})).catch((function(e){a.confirmLoading=!1,a.btnLoading=!1}))}))}))},selectTabs:function(){this.updateObject.originalPwd="",this.updateObject.newPwd="",this.updateObject.confirmPwd="",console.log(this.updateObject)},uploadSuccess:function(e,t){this.saveObject.avatarUrl=e,this.$forceUpdate()}}},m=p,g=(a("5ab5"),a("2877")),h=Object(g["a"])(m,o,s,!1,null,"681c29a4",null);t["default"]=h.exports},a850:function(e,t,a){"use strict";a("e70b")},b3ab:function(e,t,a){"use strict";a.r(t);var o=function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("a-modal",{attrs:{title:"修改头像",visible:e.visible,maskClosable:!1,confirmLoading:e.confirmLoading,width:800,footer:null},on:{cancel:e.cancelHandel}},[a("a-row",[a("a-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[a("vue-cropper",{ref:"cropper",attrs:{img:e.options.img,info:!0,autoCrop:e.options.autoCrop,autoCropWidth:e.options.autoCropWidth,autoCropHeight:e.options.autoCropHeight,fixedBox:e.options.fixedBox},on:{realTime:e.realTime}})],1),a("a-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[a("div",{staticClass:"avatar-upload-preview"},[a("img",{style:e.previews.img,attrs:{src:e.previews.url}})])])],1),a("br"),a("a-row",[a("a-col",{attrs:{lg:2,md:2}},[a("a-upload",{attrs:{name:"file",beforeUpload:e.beforeUpload,showUploadList:!1}},[a("a-button",{attrs:{icon:"upload"}},[e._v("选择图片")])],1)],1),a("a-col",{attrs:{lg:{span:1,offset:2},md:2}},[a("a-button",{attrs:{icon:"plus"},on:{click:function(t){return e.changeScale(1)}}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"minus"},on:{click:function(t){return e.changeScale(-1)}}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"undo"},on:{click:e.rotateLeft}})],1),a("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[a("a-button",{attrs:{icon:"redo"},on:{click:e.rotateRight}})],1),a("a-col",{attrs:{lg:{span:2,offset:6},md:2}},[a("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.finish("blob")}}},[e._v("保存")])],1)],1)],1)},s=[],r=(a("d3b7"),a("3ca3"),a("ddb0"),a("2b3d"),a("0fea")),n=a("4360"),i={data:function(){return{recordId:n["a"].state.user.userId,userLoad:r["hb"].icon,visible:!1,id:null,confirmLoading:!1,fileList:[],uploading:!1,options:{img:"",autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixedBox:!0},previews:{}}},methods:{edit:function(e){this.visible=!0,this.id=e},close:function(){this.id=null,this.visible=!1},cancelHandel:function(){this.close()},changeScale:function(e){e=e||1,this.$refs.cropper.changeScale(e)},rotateLeft:function(){this.$refs.cropper.rotateLeft()},rotateRight:function(){this.$refs.cropper.rotateRight()},beforeUpload:function(e){var t=this,a=new FileReader;return a.readAsDataURL(e),a.onload=function(){t.options.img=a.result},!1},finish:function(e){var t=this;console.log("finish");var a=this,o=new FormData;"blob"===e?this.$refs.cropper.getCropBlob((function(e){var s=window.URL.createObjectURL(e);t.model=!0,t.modelSrc=s,o.append("avatarUrl",s),Object(r["fb"])(o).then((function(e){console.log("upload response:",e),a.$message.success("上传成功"),a.$emit("ok",e.url),a.visible=!1})).catch((function(e){console.log(e)})),console.log(a.userLoad,a.recordId,t.modelSrc)})):this.$refs.cropper.getCropData((function(e){t.model=!0,t.modelSrc=e}))},okHandel:function(){var e=this;e.confirmLoading=!0,setTimeout((function(){e.confirmLoading=!1,e.close(),e.$message.success("上传头像成功")}),2e3)},realTime:function(e){this.previews=e}}},c=i,l=(a("a363"),a("2877")),u=Object(l["a"])(c,o,s,!1,null,"7ecffbc3",null);t["default"]=u.exports},e70b:function(e,t,a){}}]);