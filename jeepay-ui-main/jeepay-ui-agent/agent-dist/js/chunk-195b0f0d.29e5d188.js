(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-195b0f0d","chunk-6c319cee"],{"068f":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("page-header-wrapper",[a("a-card",[a("div",{staticClass:"table-page-search-wrapper"},[a("a-form",{staticClass:"table-head-ground",attrs:{layout:"inline"}},[a("div",{staticClass:"table-layer"},[a("a-form-item",{staticClass:"table-head-layout",staticStyle:{"max-width":"350px","min-width":"300px"},attrs:{label:""}},[a("a-range-picker",{attrs:{"show-time":{format:"HH:mm:ss"},format:"YYYY-MM-DD HH:mm:ss","disabled-date":t.disabledDate,ranges:t.ranges},on:{change:t.onChange},model:{value:t.selectedRange,callback:function(e){t.selectedRange=e},expression:"selectedRange"}},[a("a-icon",{attrs:{slot:"suffixIcon",type:"sync"},slot:"suffixIcon"})],1)],1),a("jeepay-text-up",{attrs:{placeholder:"通道ID",msg:t.searchData.passageId},model:{value:t.searchData.passageId,callback:function(e){t.$set(t.searchData,"passageId",e)},expression:"searchData.passageId"}}),a("jeepay-text-up",{attrs:{placeholder:"通道名",msg:t.searchData.payPassageName},model:{value:t.searchData.payPassageName,callback:function(e){t.$set(t.searchData,"payPassageName",e)},expression:"searchData.payPassageName"}}),a("jeepay-text-up",{attrs:{placeholder:"支付订单号",msg:t.searchData.payOrderId},model:{value:t.searchData.payOrderId,callback:function(e){t.$set(t.searchData,"payOrderId",e)},expression:"searchData.payOrderId"}}),a("jeepay-text-up",{attrs:{placeholder:"通道订单号",msg:t.searchData.passageOrderNo},model:{value:t.searchData.passageOrderNo,callback:function(e){t.$set(t.searchData,"passageOrderNo",e)},expression:"searchData.passageOrderNo"}}),a("a-form-model-item",{staticClass:"table-head-layout",attrs:{label:""}},[a("a-select",{attrs:{placeholder:"对应产品",allowClear:!0},model:{value:t.searchData.productId,callback:function(e){t.$set(t.searchData,"productId",e)},expression:"searchData.productId"}},t._l(t.productList,(function(e){return a("a-select-option",{key:e.productId,attrs:{value:e.productId}},[t._v(" "+t._s(e.productName+" [ ID: "+e.productId+" ]")+" ")])})),1)],1),a("a-form-item",{staticClass:"table-head-layout",attrs:{label:""}},[a("a-select",{attrs:{placeholder:"支付状态","default-value":""},model:{value:t.searchData.state,callback:function(e){t.$set(t.searchData,"state",e)},expression:"searchData.state"}},[a("a-select-option",{attrs:{value:""}},[t._v("全部")]),a("a-select-option",{attrs:{value:"0"}},[t._v("订单生成")]),a("a-select-option",{attrs:{value:"1"}},[t._v("支付中")]),a("a-select-option",{attrs:{value:"2"}},[t._v("支付成功")]),a("a-select-option",{attrs:{value:"3"}},[t._v("支付失败")]),a("a-select-option",{attrs:{value:"5"}},[t._v("测试冲正")]),a("a-select-option",{attrs:{value:"6"}},[t._v("订单关闭")]),a("a-select-option",{attrs:{value:"7"}},[t._v("出码失败")])],1)],1),a("span",{staticClass:"table-page-search-submitButtons"},[a("a-button",{attrs:{type:"primary",icon:"search",loading:t.btnLoading},on:{click:t.queryFunc}},[t._v("搜索")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{icon:"reload"},on:{click:t.resetSearch}},[t._v("重置")]),a("a-button",{staticStyle:{"margin-left":"8px"},attrs:{type:"danger",icon:"download"},on:{click:t.exportExcel}},[t._v("导出")])],1)],1)])],1),a("JeepayTable",{ref:"infoTable",attrs:{initData:!1,reqTableDataFunc:t.reqTableDataFunc,tableColumns:t.tableColumns,searchData:t.searchData,pageSize:50,rowKey:"payOrderId"},on:{btnLoadClose:function(e){t.btnLoading=!1}},scopedSlots:t._u([{key:"mchSlot",fn:function(e){var n=e.record;return[a("span",{staticStyle:{color:"#1A79FF"}},[t._v("["+t._s(n.passageId)+"]")]),t._v(" "),a("span",[t._v(t._s(n.ext.payPassageName))])]}},{key:"amountSlot",fn:function(e){var n=e.record;return[a("b",[t._v("￥"+t._s(n.amount/100))])]}},{key:"stateSlot",fn:function(e){var n=e.record;return[a("a-tag",{key:n.state,attrs:{color:0===n.state?"blue":1===n.state?"orange":2===n.state?"#4BD884":6===n.state?"":"#F03B44"}},[t._v(" "+t._s(0===n.state?"订单生成":1===n.state?"支付中":2===n.state?"支付成功":3===n.state?"支付失败":4===n.state?"已撤销":5===n.state?"测试冲正":6===n.state?"订单关闭":7===n.state?"出码失败":"未知")+" ")])]}},{key:"notifySlot",fn:function(t){var e=t.record;return[a("a-badge",{attrs:{status:1===e.notifyState?"processing":"error",text:1===e.notifyState?"已发送":"未发送"}})]}},{key:"productSlot",fn:function(e){var n=e.record;return[a("span",{staticStyle:{color:"#1A79FF"}},[t._v("["+t._s(n.productId)+"]")]),a("span",[t._v(t._s(n.productName))])]}},{key:"passageOrderNoSlot",fn:function(e){var n=e.record;return[a("b",[t._v(t._s(n.passageOrderNo))])]}},{key:"orderSlot",fn:function(e){var n=e.record;return[a("div",{staticClass:"order-list"},[a("p",[a("span",{staticStyle:{color:"#007EFF",background:"#DFEFFF"}},[t._v("支付单号")]),a("b",[t._v(t._s(n.payOrderId))])]),a("p",{staticStyle:{"margin-bottom":"0"}},[a("span",{staticStyle:{color:"#FA9D2A",background:"#FFEDD6"}},[t._v("通道单号")]),n.passageOrderNo.length>n.payOrderId.length?a("a-tooltip",{staticStyle:{"font-weight":"normal"},attrs:{placement:"bottom"}},[a("template",{slot:"title"},[a("span",[t._v(t._s(n.passageOrderNo))])]),t._v(" "+t._s(t.changeStr2ellipsis(n.passageOrderNo,n.payOrderId.length))+" ")],2):a("span",{staticStyle:{"font-weight":"normal"}},[t._v(t._s(n.passageOrderNo))])],1)])]}},{key:"opSlot",fn:function(e){var n=e.record;return[a("JeepayTableColumns",[a("a-button",{attrs:{type:"link"},on:{click:function(e){return t.detailFunc(n.payOrderId)}}},[t._v("查看详情")])],1)]}}])})],1),[a("a-drawer",{attrs:{width:"50%",placement:"right",closable:!0,visible:t.visible,title:!0===t.visible?"订单详情":""},on:{close:t.onClose}},[a("a-row",{attrs:{justify:"space-between",type:"flex"}},[a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"商户号"}},[a("b",[t._v(t._s(t.detailData.mchNo))])])],1)],1),a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"商户名称"}},[t._v(" "+t._s(t.detailData.mchName)+" ")])],1)],1),a("a-col",{attrs:{sm:24}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"支付订单号"}},[a("a-tag",{attrs:{color:"purple"}},[t._v(" "+t._s(t.detailData.payOrderId)+" ")])],1)],1)],1),a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"支付金额"}},[a("a-tag",{attrs:{color:"#4BD884"}},[t._v(" "+t._s(t.detailData.amount/100)+" ")])],1)],1)],1),a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"订单状态"}},[a("a-tag",{attrs:{color:0===t.detailData.state?"blue":1===t.detailData.state?"orange":2===t.detailData.state?"#4BD884":6===t.detailData.state?"":"#F03B44"}},[t._v(" "+t._s(0===t.detailData.state?"订单生成":1===t.detailData.state?"支付中":2===t.detailData.state?"支付成功":3===t.detailData.state?"支付失败":4===t.detailData.state?"已撤销":5===t.detailData.state?"测试冲正":6===t.detailData.state?"订单关闭":7===t.detailData.state?"出码失败":"未知")+" ")])],1)],1)],1),a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"回调状态"}},[a("a-tag",{attrs:{color:1===t.detailData.notifyState?"#4BD884":"#F03B44"}},[t._v(" "+t._s(0===t.detailData.notifyState?"未发送":1===t.detailData.notifyState?"已发送":"未知")+" ")])],1)],1)],1),a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"支付产品"}},[t._v(" ["+t._s(t.detailData.productId)+"] "+t._s(t.detailData.productName)+" ")])],1)],1),a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"创建时间"}},[t._v(" "+t._s(t.detailData.createdAt)+" ")])],1)],1),a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"更新时间"}},[t._v(" "+t._s(t.detailData.updatedAt)+" ")])],1)],1),a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"订单失效时间"}},[t._v(" "+t._s(t.detailData.expiredTime)+" ")])],1)],1),a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"支付成功时间"}},[t._v(" "+t._s(t.detailData.successTime)+" ")])],1)],1),a("a-divider"),a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"代理费率"}},[a("b",[t._v(t._s((100*t.detailData.agentPassageRate).toFixed(2))+"%")])])],1)],1),a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"代理分润"}},[a("a-tag",{attrs:{color:"pink"}},[t._v(t._s(t.detailData.agentPassageFee/100))])],1)],1)],1),a("a-divider"),a("a-col",{attrs:{sm:12}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"客户端IP"}},[t._v(" "+t._s(t.detailData.clientIp)+" ")])],1)],1)],1)],1)]],2)},r=[],s=a("513d"),o=a("4f53"),i=a("21a6"),c=a("f339"),l=a("5d5e"),u=a("0fea"),d=a("c1df"),p=a.n(d),f=[{key:"mchNo",title:"通道信息",ellipsis:!0,width:260,fixed:"left",scopedSlots:{customRender:"mchSlot"}},{key:"orderNo",title:"平台订单号",scopedSlots:{customRender:"orderSlot"},width:300,fixed:"left"},{key:"amount",title:"支付金额",ellipsis:!0,width:150,scopedSlots:{customRender:"amountSlot"}},{key:"state",title:"支付状态",scopedSlots:{customRender:"stateSlot"},width:130},{key:"wayName",title:"产品(快照)",scopedSlots:{customRender:"productSlot"}},{key:"notifyState",title:"回调状态",scopedSlots:{customRender:"notifySlot"},width:100},{key:"createdAt",dataIndex:"createdAt",title:"创建日期",width:200},{key:"successTime",dataIndex:"successTime",title:"成功日期"},{key:"op",title:"操作",width:180,fixed:"right",align:"center",scopedSlots:{customRender:"opSlot"}}],m={name:"PayOrderListPage",components:{JeepayTable:c["a"],JeepayTableColumns:l["a"],JeepayTextUp:o["a"],RefundModal:s["default"]},data:function(){return{btnLoading:!1,tableColumns:f,searchData:{},createdStart:"",createdEnd:"",visible:!1,detailData:{},selectedRange:null,productList:[],ranges:{"今天":[p()().startOf("day"),p()().endOf("day")],"昨天":[p()().subtract(1,"day").startOf("day"),p()().subtract(1,"day").endOf("day")],"近一周":[p()().subtract(1,"week").startOf("day"),p()().endOf("day")]}}},computed:{},mounted:function(){var t=this;u["B"].list(u["k"],{pageSize:-1}).then((function(e){t.productList=e.records})),this.selectedRange=[p()().startOf("day"),p()().endOf("day")],this.searchData.createdStart=this.selectedRange[0].format("YYYY-MM-DD HH:mm:ss"),this.searchData.createdEnd=this.selectedRange[1].format("YYYY-MM-DD HH:mm:ss"),this.queryFunc()},methods:{queryFunc:function(){this.btnLoading=!0,this.$refs.infoTable.refTable(!0)},reqTableDataFunc:function(t){return u["B"].list(u["j"],t)},searchFunc:function(){this.$refs.infoTable.refTable(!1)},detailFunc:function(t){var e=this;u["B"].getById(u["j"],t).then((function(t){e.detailData=t})),this.visible=!0},moment:p.a,onChange:function(t,e){this.searchData.createdStart=e[0],this.searchData.createdEnd=e[1]},disabledDate:function(t){return t&&t>p()().endOf("day")},onClose:function(){this.visible=!1},resetSearch:function(){this.searchData={},this.selectedRange=null},exportExcel:function(){Object(u["q"])("/api/payOrderExport/exportPassageExcel",this.searchData).then((function(t){var e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Object(i["saveAs"])(e,p()().format("YYYY-MM-DD")+"-通道代理订单流水.xlsx")})).catch((function(t){var e=new Blob([t],{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"});Object(i["saveAs"])(e,p()().format("YYYY-MM-DD")+"-通道代理订单流水.xlsx")}))}}},h=m,g=(a("ac88"),a("2877")),b=Object(g["a"])(h,n,r,!1,null,"99c63b6c",null);e["default"]=b.exports},"0fea":function(t,e,a){"use strict";a.d(e,"B",(function(){return r})),a.d(e,"d",(function(){return s})),a.d(e,"e",(function(){return o})),a.d(e,"i",(function(){return i})),a.d(e,"f",(function(){return c})),a.d(e,"m",(function(){return l})),a.d(e,"j",(function(){return u})),a.d(e,"n",(function(){return d})),a.d(e,"k",(function(){return p})),a.d(e,"o",(function(){return f})),a.d(e,"h",(function(){return m})),a.d(e,"g",(function(){return h})),a.d(e,"l",(function(){return g})),a.d(e,"c",(function(){return b})),a.d(e,"a",(function(){return v})),a.d(e,"b",(function(){return y})),a.d(e,"F",(function(){return D})),a.d(e,"r",(function(){return _})),a.d(e,"y",(function(){return w})),a.d(e,"z",(function(){return S})),a.d(e,"E",(function(){return x})),a.d(e,"D",(function(){return O})),a.d(e,"v",(function(){return k})),a.d(e,"w",(function(){return T})),a.d(e,"A",(function(){return F})),a.d(e,"s",(function(){return R})),a.d(e,"p",(function(){return C})),a.d(e,"u",(function(){return I})),a.d(e,"x",(function(){return E})),a.d(e,"C",(function(){return q})),a.d(e,"t",(function(){return A})),a.d(e,"q",(function(){return L}));a("2ca0"),a("ac1f"),a("5319");var n=a("4667"),r={list:function(t,e){return n["a"].request({url:t,method:"GET",params:e},!0,!0,!1)},add:function(t,e){return n["a"].request({url:t,method:"POST",data:e},!0,!0,!1)},getById:function(t,e){return n["a"].request({url:t+"/"+e,method:"GET"},!0,!0,!1)},updateById:function(t,e,a){return n["a"].request({url:t+"/"+e,method:"PUT",data:a},!0,!0,!1)},delById:function(t,e){return n["a"].request({url:t+"/"+e,method:"DELETE"},!0,!0,!1)}},s="/api/mchInfo",o="/api/passageInfo",i="/api/mchApps",c="/api/agentPassage",l="/api/payOrder",u="/api/passagePayOrder",d="/api/refundOrder",p="/api/payWays",f="/api/transferOrders",m="/api/divisionReceiverGroups",h="/api/divisionReceivers",g="/api/division/records",b="/api/agentHistory",v="/api/agentDayStat",y="/api/agentDivision",D={avatar:n["a"].baseUrl+"/api/ossFiles/avatar",cert:n["a"].baseUrl+"/api/ossFiles/cert"};function _(){return n["a"].request({url:"/api/agentInfo",method:"GET"})}function w(t){return n["a"].request({url:"api/paytest/payways/"+t,method:"GET"})}function S(t){return n["a"].request({url:"/api/paytest/payOrders",method:"POST",data:t})}function x(t){return n["a"].request({url:"/api/current/modifyPwd",method:"put",data:t})}function O(t){return n["a"].request({url:"/api/current/user",method:"put",data:t})}function k(){return n["a"].request({url:"/api/current/user",method:"get"})}function T(){var t=document.location.protocol+"//"+document.location.host;return t="http://agent-api.bainian-pay.com",t.startsWith("https:")?"wss://"+t.replace("https://",""):"ws://"+t.replace("http://","")}function F(t){return n["a"].request({url:"api/mchTransfers/ifCodes/"+t,method:"GET"})}function R(t,e,a){return n["a"].request({url:"/api/mchTransfers/channelUserId",method:"GET",params:{ifCode:t,appId:e,extParam:a}})}function C(t){return n["a"].request({url:"/api/mchTransfers/doTransfer",method:"POST",data:t},!0,!0,!0)}function I(t){return n["a"].request({url:"/api/mch/payConfigs/ifCodes/"+t,method:"GET"},!0,!0,!0)}function E(t,e,a){return n["a"].request({url:"/api/payOrder/refunds/"+t,method:"POST",data:{refundAmount:e,refundReason:a}})}function q(t){return n["a"].request({url:"/api/division/records/resend/"+t,method:"POST"})}function A(){return n["a"].request({url:"/api/current/getGoogleKey",method:"get"})}function L(t,e){return n["a"].request({url:t,method:"POST",data:e,responseType:"arraybuffer"},!0,!1,!0)}},"21a6":function(t,e,a){(function(a){var n,r,s;(function(a,o){r=[],n=o,s="function"===typeof n?n.apply(e,r):n,void 0===s||(t.exports=s)})(0,(function(){"use strict";function e(t,e){return"undefined"==typeof e?e={autoBom:!1}:"object"!=typeof e&&(console.warn("Deprecated: Expected third argument to be a object"),e={autoBom:!e}),e.autoBom&&/^\s*(?:text\/\S*|application\/xml|\S*\/\S*\+xml)\s*;.*charset\s*=\s*utf-8/i.test(t.type)?new Blob(["\ufeff",t],{type:t.type}):t}function n(t,e,a){var n=new XMLHttpRequest;n.open("GET",t),n.responseType="blob",n.onload=function(){c(n.response,e,a)},n.onerror=function(){console.error("could not download file")},n.send()}function r(t){var e=new XMLHttpRequest;e.open("HEAD",t,!1);try{e.send()}catch(t){}return 200<=e.status&&299>=e.status}function s(t){try{t.dispatchEvent(new MouseEvent("click"))}catch(n){var e=document.createEvent("MouseEvents");e.initMouseEvent("click",!0,!0,window,0,0,0,80,20,!1,!1,!1,!1,0,null),t.dispatchEvent(e)}}var o="object"==typeof window&&window.window===window?window:"object"==typeof self&&self.self===self?self:"object"==typeof a&&a.global===a?a:void 0,i=o.navigator&&/Macintosh/.test(navigator.userAgent)&&/AppleWebKit/.test(navigator.userAgent)&&!/Safari/.test(navigator.userAgent),c=o.saveAs||("object"!=typeof window||window!==o?function(){}:"download"in HTMLAnchorElement.prototype&&!i?function(t,e,a){var i=o.URL||o.webkitURL,c=document.createElement("a");e=e||t.name||"download",c.download=e,c.rel="noopener","string"==typeof t?(c.href=t,c.origin===location.origin?s(c):r(c.href)?n(t,e,a):s(c,c.target="_blank")):(c.href=i.createObjectURL(t),setTimeout((function(){i.revokeObjectURL(c.href)}),4e4),setTimeout((function(){s(c)}),0))}:"msSaveOrOpenBlob"in navigator?function(t,a,o){if(a=a||t.name||"download","string"!=typeof t)navigator.msSaveOrOpenBlob(e(t,o),a);else if(r(t))n(t,a,o);else{var i=document.createElement("a");i.href=t,i.target="_blank",setTimeout((function(){s(i)}))}}:function(t,e,a,r){if(r=r||open("","_blank"),r&&(r.document.title=r.document.body.innerText="downloading..."),"string"==typeof t)return n(t,e,a);var s="application/octet-stream"===t.type,c=/constructor/i.test(o.HTMLElement)||o.safari,l=/CriOS\/[\d]+/.test(navigator.userAgent);if((l||s&&c||i)&&"undefined"!=typeof FileReader){var u=new FileReader;u.onloadend=function(){var t=u.result;t=l?t:t.replace(/^data:[^;]*;/,"data:attachment/file;"),r?r.location.href=t:location=t,r=null},u.readAsDataURL(t)}else{var d=o.URL||o.webkitURL,p=d.createObjectURL(t);r?r.location=p:location.href=p,r=null,setTimeout((function(){d.revokeObjectURL(p)}),4e4)}});o.saveAs=c.saveAs=c,t.exports=c}))}).call(this,a("c8ba"))},"27fc":function(t,e,a){},"31ea":function(t,e,a){},44423:function(t,e,a){"use strict";a("aa30")},"4f53":function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"jee-text-up"},[a("a-input",{attrs:{required:"required",value:t.msg},on:{input:function(e){return t.$emit("input",e.target.value)}}}),a("label",[t._v(t._s(t.placeholder))])],1)},r=[],s={name:"JeepayTextUp",props:{msg:{type:String},placeholder:{type:String}}},o=s,i=(a("a72a"),a("2877")),c=Object(i["a"])(o,n,r,!1,null,"4d207278",null);e["a"]=c.exports},"513d":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-modal",{attrs:{title:"退款",visible:t.visible,"confirm-loading":t.confirmLoading,closable:!1},on:{ok:t.handleOk,cancel:t.handleCancel}},[a("a-row",[a("a-col",{attrs:{sm:24}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"支付订单号"}},[a("a-tag",{attrs:{color:"purple"}},[t._v(" "+t._s(t.detailData.payOrderId)+" ")])],1)],1)],1),a("a-col",{attrs:{sm:24}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"支付金额"}},[a("a-tag",{attrs:{color:"#4BD884"}},[t._v(" "+t._s(t.detailData.amount/100)+" ")])],1)],1)],1),a("a-col",{attrs:{sm:24}},[a("a-descriptions",[a("a-descriptions-item",{attrs:{label:"可退金额"}},[a("a-tag",{attrs:{color:"pink"}},[t._v(" "+t._s(t.nowRefundAmount)+" ")])],1)],1)],1)],1),a("a-form-model",{ref:"refundInfo",attrs:{rules:t.rules,model:t.refund}},[a("a-form-model-item",{attrs:{label:"退款金额",prop:"refundAmount"}},[a("a-input-number",{staticStyle:{width:"100%"},attrs:{precision:2},model:{value:t.refund.refundAmount,callback:function(e){t.$set(t.refund,"refundAmount",e)},expression:"refund.refundAmount"}})],1),a("a-form-model-item",{attrs:{label:"退款原因",prop:"refundReason"}},[a("a-input",{attrs:{type:"textarea"},model:{value:t.refund.refundReason,callback:function(e){t.$set(t.refund,"refundReason",e)},expression:"refund.refundReason"}})],1)],1)],1)],1)},r=[],s=a("0fea"),o={props:{callbackFunc:{type:Function,default:function(){return function(){return{}}}}},data:function(){var t=this;return{recordId:"",labelCol:{span:4},wrapperCol:{span:16},visible:!1,confirmLoading:!1,detailData:{},refund:{},rules:{refundReason:[{min:0,max:256,required:!0,trigger:"blur",message:"请输入退款原因，最长不超过256个字符"}],refundAmount:[{required:!0,message:"请输入金额",trigger:"blur"},{validator:function(e,a,n){(a<.01||a>t.nowRefundAmount)&&n("退款金额不能小于0.01，或者大于可退金额"),n()}}]}}},computed:{nowRefundAmount:function(){return(this.detailData.amount-this.detailData.refundAmount)/100}},methods:{show:function(t){void 0!==this.$refs.refundInfo&&this.$refs.refundInfo.resetFields(),this.recordId=t,this.visible=!0,this.refund={};var e=this;s["B"].getById(s["m"],t).then((function(t){e.detailData=t}))},handleOk:function(t){var e=this;this.$refs.refundInfo.validate((function(t){if(t){e.confirmLoading=!0;var a=e;Object(s["x"])(a.recordId,a.refund.refundAmount,a.refund.refundReason).then((function(t){if(a.visible=!1,a.confirmLoading=!1,0===t.state||3===t.state)var e=a.$infoBox.modalError("退款失败",(function(n){return a.buildModalText(t,n,(function(){e.destroy()}))}));else if(1===t.state){var n=a.$infoBox.modalWarning("退款中",(function(e){return a.buildModalText(t,e,(function(){n.destroy()}))}));a.callbackFunc()}else if(2===t.state)a.$message.success("退款成功"),a.callbackFunc();else var r=a.$infoBox.modalWarning("退款状态未知",(function(e){return a.buildModalText(t,e,(function(){r.destroy()}))}))})).catch((function(){a.confirmLoading=!1}))}}))},handleCancel:function(t){this.visible=!1},buildModalText:function(t,e,a){var n=this,r=e("a",{on:{click:function(){a(),n.$router.push({name:"ENT_REFUND_ORDER"})}}});return r.text="退款列表",e("div",[e("div",t.errCode?"错误码：".concat(t.errCode):""),e("div",t.errMsg?"错误信息：".concat(t.errMsg):""),e("div",[e("span","请到"),r,e("span","中查看详细信息")])])}}},i=o,c=a("2877"),l=Object(c["a"])(i,n,r,!1,null,"6fe3a7e0",null);e["default"]=l.exports},"5d5e":function(t,e,a){"use strict";a("d81d");var n,r,s={name:"JeepayTableColumns",render:function(t,e){var a=arguments[0],n=[];if(this.$slots.default.map((function(t){return t.tag&&n.push(t),!1})),n.length<=3)return t("div",{style:"display:flex; justify-content: space-evenly;"},n);for(var r=[n[0],n[1]],s=[],o=2;o<n.length;o++)s.push(a("a-menu-item",[n[o]]));return a("div",{style:"display:flex; justify-content: space-evenly;"},[" ",r,a("a-dropdown",[a("a-button",{style:"",attrs:{type:"link"},class:"ant-dropdown-link"},["更多",a("a-icon",{attrs:{type:"down"}})]),a("a-menu",{slot:"overlay"},[s])])])}},o=s,i=(a("44423"),a("2877")),c=Object(i["a"])(o,n,r,!1,null,"207fd926",null);e["a"]=c.exports},a72a:function(t,e,a){"use strict";a("de7e")},aa30:function(t,e,a){},ac88:function(t,e,a){"use strict";a("31ea")},de7e:function(t,e,a){},f339:function(t,e,a){"use strict";var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-table",{attrs:{columns:t.tableColumns,"data-source":t.apiResData.records,pagination:t.pagination,loading:t.showLoading,"row-selection":t.rowSelection,rowKey:t.rowKey,scroll:{x:t.scrollX},customRow:function(e,a){return t.tableRowCrossColor?{style:{"background-color":a%2==0?"#FCFCFC":"#FFFFFF"}}:{}}},on:{change:t.handleTableChange},scopedSlots:t._u([t._l(t.columnsCustomSlots,(function(e){return{key:e.customRender,fn:function(a){return[t._t(e.customRender,null,{record:a})]}}}))],null,!0)})],1)},r=[],s=a("5530"),o=(a("a9e3"),a("d81d"),a("4de4"),{name:"JeepayTable",props:{initData:{type:Boolean,default:!0},tableColumns:Array,reqTableDataFunc:{type:Function},currentChange:{type:Function,default:function(t,e){}},searchData:Object,pageSize:{type:Number,default:10},rowSelection:Object,rowKey:{type:[String,Function]},scrollX:{type:Number,default:800},tableRowCrossColor:{type:Boolean,default:!1}},data:function(){return{apiResData:{total:0,records:[]},iPage:{pageNumber:1,pageSize:this.pageSize},pagination:{total:0,current:1,pageSizeOptions:["10","20","50","100"],pageSize:this.pageSize,showSizeChanger:!0,showTotal:function(t){return"共".concat(t,"条")}},showLoading:!1}},computed:{columnsCustomSlots:function(){return this.tableColumns.filter((function(t){return t.scopedSlots})).map((function(t){return t.scopedSlots}))}},mounted:function(){this.initData&&this.refTable(!0)},methods:{handleTableChange:function(t,e,a){this.pagination=t,this.iPage=Object(s["a"])({pageSize:t.pageSize,pageNumber:t.current,sortField:a.columnKey,sortOrder:a.order},e),this.refTable()},refTable:function(){var t=this,e=arguments.length>0&&void 0!==arguments[0]&&arguments[0],a=this;e&&(this.iPage.pageNumber=1,this.pagination.current=1),this.showLoading=!0,this.reqTableDataFunc(Object.assign({},this.iPage,this.searchData)).then((function(e){t.pagination.total=e.total,t.apiResData=e,t.showLoading=!1,0===e.records.length&&t.iPage.pageNumber>1&&a.$nextTick((function(){var n=e.total/t.iPage.pageSize+(e.total%t.iPage.pageSize===0?0:1);if(0===n)return!1;var r=t.iPage.pageNumber-1>n?n:t.iPage.pageNumber-1;t.iPage.pageNumber=r,t.pagination.current=r,a.refTable(!1)})),a.$emit("btnLoadClose")})).catch((function(e){t.showLoading=!1,a.$emit("btnLoadClose")}))}}}),i=o,c=(a("f705"),a("2877")),l=Object(c["a"])(i,n,r,!1,null,null,null);e["a"]=l.exports},f705:function(t,e,a){"use strict";a("27fc")}}]);