(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-076d0b4f","chunk-1250ae47"],{"0fea":function(e,t,o){"use strict";o.d(t,"B",(function(){return n})),o.d(t,"d",(function(){return r})),o.d(t,"e",(function(){return i})),o.d(t,"i",(function(){return s})),o.d(t,"f",(function(){return u})),o.d(t,"m",(function(){return c})),o.d(t,"j",(function(){return d})),o.d(t,"n",(function(){return l})),o.d(t,"k",(function(){return f})),o.d(t,"o",(function(){return p})),o.d(t,"h",(function(){return g})),o.d(t,"g",(function(){return m})),o.d(t,"l",(function(){return h})),o.d(t,"c",(function(){return b})),o.d(t,"a",(function(){return w})),o.d(t,"b",(function(){return v})),o.d(t,"F",(function(){return y})),o.d(t,"r",(function(){return C})),o.d(t,"y",(function(){return O})),o.d(t,"z",(function(){return j})),o.d(t,"E",(function(){return P})),o.d(t,"D",(function(){return T})),o.d(t,"v",(function(){return $})),o.d(t,"w",(function(){return G})),o.d(t,"A",(function(){return x})),o.d(t,"s",(function(){return L})),o.d(t,"p",(function(){return A})),o.d(t,"u",(function(){return U})),o.d(t,"x",(function(){return k})),o.d(t,"C",(function(){return q})),o.d(t,"t",(function(){return S})),o.d(t,"q",(function(){return E}));o("2ca0"),o("ac1f"),o("5319");var a=o("4667"),n={list:function(e,t){return a["a"].request({url:e,method:"GET",params:t},!0,!0,!1)},add:function(e,t){return a["a"].request({url:e,method:"POST",data:t},!0,!0,!1)},getById:function(e,t){return a["a"].request({url:e+"/"+t,method:"GET"},!0,!0,!1)},updateById:function(e,t,o){return a["a"].request({url:e+"/"+t,method:"PUT",data:o},!0,!0,!1)},delById:function(e,t){return a["a"].request({url:e+"/"+t,method:"DELETE"},!0,!0,!1)}},r="/api/mchInfo",i="/api/passageInfo",s="/api/mchApps",u="/api/agentPassage",c="/api/payOrder",d="/api/passagePayOrder",l="/api/refundOrder",f="/api/payWays",p="/api/transferOrders",g="/api/divisionReceiverGroups",m="/api/divisionReceivers",h="/api/division/records",b="/api/agentHistory",w="/api/agentDayStat",v="/api/agentDivision",y={avatar:a["a"].baseUrl+"/api/ossFiles/avatar",cert:a["a"].baseUrl+"/api/ossFiles/cert"};function C(){return a["a"].request({url:"/api/agentInfo",method:"GET"})}function O(e){return a["a"].request({url:"api/paytest/payways/"+e,method:"GET"})}function j(e){return a["a"].request({url:"/api/paytest/payOrders",method:"POST",data:e})}function P(e){return a["a"].request({url:"/api/current/modifyPwd",method:"put",data:e})}function T(e){return a["a"].request({url:"/api/current/user",method:"put",data:e})}function $(){return a["a"].request({url:"/api/current/user",method:"get"})}function G(){var e=document.location.protocol+"//"+document.location.host;return e="http://agent-api.bainian-pay.com",e.startsWith("https:")?"wss://"+e.replace("https://",""):"ws://"+e.replace("http://","")}function x(e){return a["a"].request({url:"api/mchTransfers/ifCodes/"+e,method:"GET"})}function L(e,t,o){return a["a"].request({url:"/api/mchTransfers/channelUserId",method:"GET",params:{ifCode:e,appId:t,extParam:o}})}function A(e){return a["a"].request({url:"/api/mchTransfers/doTransfer",method:"POST",data:e},!0,!0,!0)}function U(e){return a["a"].request({url:"/api/mch/payConfigs/ifCodes/"+e,method:"GET"},!0,!0,!0)}function k(e,t,o){return a["a"].request({url:"/api/payOrder/refunds/"+e,method:"POST",data:{refundAmount:t,refundReason:o}})}function q(e){return a["a"].request({url:"/api/division/records/resend/"+e,method:"POST"})}function S(){return a["a"].request({url:"/api/current/getGoogleKey",method:"get"})}function E(e,t){return a["a"].request({url:e,method:"POST",data:t,responseType:"arraybuffer"},!0,!1,!0)}},"4cbe":function(e,t,o){"use strict";o("b21d")},6857:function(e,t,o){"use strict";o("955f")},"955f":function(e,t,o){},a664:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",{staticStyle:{background:"#fff","border-radius":"10px"}},[o("a-tabs",{on:{change:e.selectTabs}},[o("a-tab-pane",{key:"1",attrs:{tab:"基本信息"}},[o("div",{staticClass:"account-settings-info-view"},[o("a-row",{attrs:{gutter:16}},[o("a-col",{attrs:{md:16,lg:16}},[o("a-form-model",{ref:"infoFormModel",attrs:{model:e.saveObject,"label-col":{span:9},"wrapper-col":{span:10}}},[o("a-form-model-item",{attrs:{label:"用户登录名:"}},[o("a-input",{attrs:{disabled:""},model:{value:e.saveObject.loginUsername,callback:function(t){e.$set(e.saveObject,"loginUsername",t)},expression:"saveObject.loginUsername"}})],1),o("a-form-model-item",{attrs:{label:"开启谷歌验证："}},[o("a-radio-group",{on:{change:e.googleAuthChange},model:{value:e.googleAuth,callback:function(t){e.googleAuth=t},expression:"googleAuth"}},[o("a-radio",{attrs:{value:1}},[e._v("启用")]),o("a-radio",{attrs:{value:0}},[e._v("禁用")])],1)],1),o("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.showGoogleQrCode,expression:"showGoogleQrCode"}],attrs:{label:"请使用Google身份验证器扫描码："}},[o("GoogleAuthQrCode",{ref:"googleAuthQrCode"})],1),o("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.showGoogleQrCode,expression:"showGoogleQrCode"}],attrs:{label:"Google验证码："}},[o("a-input",{attrs:{type:"number"},model:{value:e.googleCode,callback:function(t){e.googleCode=t},expression:"googleCode"}})],1),o("a-form-model-item",{directives:[{name:"show",rawName:"v-show",value:e.showGoogleTryCancel,expression:"showGoogleTryCancel"}],attrs:{label:"Google验证码："}},[o("a-input",{attrs:{type:"number"},model:{value:e.googleCode,callback:function(t){e.googleCode=t},expression:"googleCode"}})],1)],1),o("a-form-item",{staticStyle:{display:"flex","justify-content":"center"}},[o("a-button",{attrs:{type:"primary",icon:"check-circle",disabled:e.canUpdate,loading:e.btnLoading},on:{click:e.changeInfo}},[e._v("确认更新")])],1)],1)],1)],1)]),o("a-tab-pane",{key:"2",attrs:{tab:"密码设置"}},[o("div",{staticClass:"account-settings-info-view"},[o("a-row",{attrs:{gutter:16}},[o("a-col",{attrs:{md:16,lg:16}},[o("a-form-model",{ref:"pwdFormModel",attrs:{model:e.updateObject,"label-col":{span:9},"wrapper-col":{span:10},rules:e.rulesPass}},[o("a-form-model-item",{attrs:{label:"原密码：",prop:"originalPwd"}},[o("a-input-password",{attrs:{autocomplete:"new-password",placeholder:"请输入原密码"},model:{value:e.updateObject.originalPwd,callback:function(t){e.$set(e.updateObject,"originalPwd",t)},expression:"updateObject.originalPwd"}})],1),o("a-form-model-item",{attrs:{label:"新密码：",prop:"newPwd"}},[o("a-input-password",{attrs:{autocomplete:"new-password",placeholder:"请输入新密码"},model:{value:e.updateObject.newPwd,callback:function(t){e.$set(e.updateObject,"newPwd",t)},expression:"updateObject.newPwd"}})],1),o("a-form-model-item",{attrs:{label:"确认新密码：",prop:"confirmPwd"}},[o("a-input-password",{attrs:{autocomplete:"new-password",placeholder:"确认新密码"},model:{value:e.updateObject.confirmPwd,callback:function(t){e.$set(e.updateObject,"confirmPwd",t)},expression:"updateObject.confirmPwd"}})],1)],1),o("a-form-item",{staticStyle:{display:"flex","justify-content":"center"}},[o("a-button",{attrs:{type:"primary",icon:"safety-certificate",loading:e.btnLoading},on:{click:e.confirm}},[e._v("更新密码")])],1)],1)],1)],1)])],1)],1)},n=[],r=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("div",[o("a-upload",{attrs:{name:"file",action:e.action,headers:e.headers,showUploadList:!1,multiple:!0,"before-upload":e.beforeUpload},on:{change:e.handleChange}},[e._t("uploadSlot",null,{loading:e.loading})],2)],1)},i=[],s=(o("a9e3"),o("381c")),u=o("ffef");function c(){var e={};return e[s["b"].ACCESS_TOKEN_NAME]=u["a"].getToken(),e}var d={name:"JeepayUpload",props:{action:{type:String,default:""},size:{type:Number,default:10},num:{type:Number,default:1}},data:function(){return{loading:!1,fileList:[],headers:c()}},created:function(){},methods:{handleChange:function(e){"uploading"===e.file.status&&(this.loading=!0),"done"===e.file.status?(this.loading=!1,this.$emit("uploadSuccess",e.file.response.data)):"error"===e.file.status&&this.$message.error("上传失败")},beforeUpload:function(e){var t=e.size/1024/1024<this.size;return t||this.$message.error("文件应小于"+this.size+"M!"),t}}},l=d,f=o("2877"),p=Object(f["a"])(l,r,i,!1,null,null,null),g=p.exports,m=o("0fea"),h=o("b3ab"),b=o("4360"),w=o("7ded"),v=o("27ae"),y=o("57cd"),C={components:{AvatarModal:h["default"],JeepayUpload:g,GoogleAuthQrCode:y["default"]},data:function(){var e=this;return{action:m["F"].avatar,btnLoading:!1,saveObject:{loginUsername:""},googleCode:"",googleAuth:0,googleKey:"",originalGoogleAuth:0,showGoogleTryCancel:!1,canUpdate:!0,updateObject:{originalPwd:"",newPwd:"",confirmPwd:""},showGoogleQrCode:!1,recordId:b["a"].state.user.userId,rulesPass:{originalPwd:[{required:!0,message:"请输入原密码",trigger:"blur"}],newPwd:[{min:6,max:12,required:!0,message:"请输入6-12位新密码",trigger:"blur"}],confirmPwd:[{required:!0,message:"请确认输入新密码",trigger:"blur"},{validator:function(t,o,a){e.updateObject.newPwd===o?a():a("新密码与确认密码不一致")}}]}}},computed:{},created:function(){this.detail()},methods:{detail:function(){var e=this;Object(m["v"])().then((function(t){e.saveObject=t,e.googleAuth=t.ext.googleAuth,e.originalGoogleAuth=t.ext.googleAuth}))},googleAuthChange:function(){var e=this;1===this.googleAuth&&0===this.originalGoogleAuth?(e.$store.commit("showLoading"),Object(m["t"])().then((function(t){e.$store.commit("hideLoading"),e.$refs.googleAuthQrCode.show(t.qrCode),e.googleKey=t.key,e.showGoogleQrCode=!0,e.showGoogleTryCancel=!1,e.canUpdate=!1}))):1===this.originalGoogleAuth&&0===this.googleAuth?(e.showGoogleTryCancel=!0,e.googleKey="",e.canUpdate=!1):(e.showGoogleQrCode=!1,e.googleCode="",e.canUpdate=!0,e.showGoogleTryCancel=!1)},changeInfo:function(){var e=this,t=this;this.$refs.infoFormModel.validate((function(o){o&&e.$infoBox.confirmPrimary("确认更新信息吗？","",(function(){t.btnLoading=!0,t.$store.commit("showLoading"),t.saveObject.googleAuth=t.googleAuth,t.saveObject.googleKey=t.googleKey,t.saveObject.googleCode=t.googleCode,Object(m["D"])(t.saveObject).then((function(e){return t.btnLoading=!1,t.showGoogleQrCode=!1,t.googleCode="",t.canUpdate=!0,t.showGoogleTryCancel=!1,t.$store.commit("hideLoading"),Object(w["a"])()})).then((function(e){b["a"].commit("SET_USER_INFO",e),t.originalGoogleAuth=e.googleAuth,t.$message.success("修改成功")})).catch((function(e){t.$store.commit("hideLoading"),t.btnLoading=!1,t.$message.error("修改失败")}))}))}))},confirm:function(e){var t=this,o=this;this.$refs.pwdFormModel.validate((function(e){e&&t.$infoBox.confirmPrimary("确认更新密码吗？","",(function(){o.btnLoading=!0,o.confirmLoading=!0,o.updateObject.recordId=o.recordId,o.updateObject.originalPwd=v["Base64"].encode(o.updateObject.originalPwd),o.updateObject.confirmPwd=v["Base64"].encode(o.updateObject.confirmPwd),t.$delete(t.updateObject,"newPwd"),Object(m["E"])(o.updateObject).then((function(e){o.$message.success("修改成功"),t.$store.dispatch("Logout").then((function(){t.$router.push({name:"login"})}))})).catch((function(e){o.confirmLoading=!1,o.btnLoading=!1}))}))}))},selectTabs:function(){this.updateObject.originalPwd="",this.updateObject.newPwd="",this.updateObject.confirmPwd=""},uploadSuccess:function(e,t){this.saveObject.avatarUrl=e,this.$forceUpdate()}}},O=C,j=(o("6857"),Object(f["a"])(O,a,n,!1,null,"cced2c38",null));t["default"]=j.exports},b21d:function(e,t,o){},b3ab:function(e,t,o){"use strict";o.r(t);var a=function(){var e=this,t=e.$createElement,o=e._self._c||t;return o("a-modal",{attrs:{title:"修改头像",visible:e.visible,maskClosable:!1,confirmLoading:e.confirmLoading,width:800,footer:null},on:{cancel:e.cancelHandel}},[o("a-row",[o("a-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[o("vue-cropper",{ref:"cropper",attrs:{img:e.options.img,info:!0,autoCrop:e.options.autoCrop,autoCropWidth:e.options.autoCropWidth,autoCropHeight:e.options.autoCropHeight,fixedBox:e.options.fixedBox},on:{realTime:e.realTime}})],1),o("a-col",{style:{height:"350px"},attrs:{xs:24,md:12}},[o("div",{staticClass:"avatar-upload-preview"},[o("img",{style:e.previews.img,attrs:{src:e.previews.url}})])])],1),o("br"),o("a-row",[o("a-col",{attrs:{lg:2,md:2}},[o("a-upload",{attrs:{name:"file",beforeUpload:e.beforeUpload,showUploadList:!1}},[o("a-button",{attrs:{icon:"upload"}},[e._v("选择图片")])],1)],1),o("a-col",{attrs:{lg:{span:1,offset:2},md:2}},[o("a-button",{attrs:{icon:"plus"},on:{click:function(t){return e.changeScale(1)}}})],1),o("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[o("a-button",{attrs:{icon:"minus"},on:{click:function(t){return e.changeScale(-1)}}})],1),o("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[o("a-button",{attrs:{icon:"undo"},on:{click:e.rotateLeft}})],1),o("a-col",{attrs:{lg:{span:1,offset:1},md:2}},[o("a-button",{attrs:{icon:"redo"},on:{click:e.rotateRight}})],1),o("a-col",{attrs:{lg:{span:2,offset:6},md:2}},[o("a-button",{attrs:{type:"primary"},on:{click:function(t){return e.finish("blob")}}},[e._v("保存")])],1)],1)],1)},n=[],r=(o("d3b7"),o("3ca3"),o("ddb0"),o("2b3d"),o("0fea")),i=o("4360"),s={data:function(){return{recordId:i["a"].state.user.userId,userLoad:r["F"].avatar,visible:!1,id:null,confirmLoading:!1,fileList:[],uploading:!1,options:{img:"",autoCrop:!0,autoCropWidth:200,autoCropHeight:200,fixedBox:!0},previews:{}}},methods:{edit:function(e){this.visible=!0,this.id=e},close:function(){this.id=null,this.visible=!1},cancelHandel:function(){this.close()},changeScale:function(e){e=e||1,this.$refs.cropper.changeScale(e)},rotateLeft:function(){this.$refs.cropper.rotateLeft()},rotateRight:function(){this.$refs.cropper.rotateRight()},beforeUpload:function(e){var t=this,o=new FileReader;return o.readAsDataURL(e),o.onload=function(){t.options.img=o.result},!1},finish:function(e){var t=this,o=this,a=new FormData;"blob"===e?this.$refs.cropper.getCropBlob((function(e){var n=window.URL.createObjectURL(e);t.model=!0,t.modelSrc=n,a.append("avatarUrl",n),Object(r["D"])(a).then((function(e){o.$message.success("上传成功"),o.$emit("ok",e.url),o.visible=!1})).catch((function(e){}))})):this.$refs.cropper.getCropData((function(e){t.model=!0,t.modelSrc=e}))},okHandel:function(){var e=this;e.confirmLoading=!0,setTimeout((function(){e.confirmLoading=!1,e.close(),e.$message.success("上传头像成功")}),2e3)},realTime:function(e){this.previews=e}}},u=s,c=(o("4cbe"),o("2877")),d=Object(c["a"])(u,a,n,!1,null,"4a24de63",null);t["default"]=d.exports}}]);